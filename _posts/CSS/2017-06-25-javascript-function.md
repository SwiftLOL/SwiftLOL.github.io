---
layout: post
title:  "javascript学习笔记三(函数)"
date:   2017-06-25 16:00:00
author: wangjiajiajohn
categories: javascript学习笔记
tags: javascript function
---


### javascript学习笔记三(函数及作用域链)


# 1. 函数的定义

函数具有两种定义方式，一个是函数声明，一个是函数表达式。在非严格模式下，函数具有函数声明提升的能力。也就是说可以先使用后调用通过函数声明定义的函数。

函数具有的属性有:

  * length  函数参数的个数

  * prototype 函数的原型

  * 非继承而来的apply 

  * 非继承来的call
  
  * bind() 返回一个新的函数，并将对象绑定到这个新函数上，以后访问这个函数的时候，this指向将是这个参数对象。

而函数的变量对象中的属性有: this、arguments(callee属性指向arguments所属的函数)、caller(调用这个函数的函数)


# 2. 函数的作用域链

执行环境定义了函数和对象有权访问的数据，每个执行环境都有一个与之对于的变量对象,存储在函数执行环境scope属性中。作用域链中存放了当前函数、外层函数、外外层函数....一直到全局对象的变量对象.

对于函数而言这个变量对象就是这个函数的活动对象，活动对象里定义了函数中所有的局部变量和方法。而对于对象来说，对象的变量对象就是自身,另外对象所涉及到的作用域链是其原型链

当定义一个函数的时候，解释器会为这个函数创建一个执行环境executeContext,并创建一个作用域链赋值给executeContext的scope属性。之后当调用这个函数的时候，解释器就会copy一份executeContext,并用this、argument、各个参数来初始化这个函数的活动对象，然后执行这个函数。当函数执行完毕，解释器会推出这个executeContext,并将其和其作用域链释放。但是如果这个函数里面有闭包的话，只要这个闭包存在，那么这个函数executeContext的活动对象就不会被释放，一直存储在闭包的作用域链中。

函数在访问一个变量的时候，会按照变量的标识符在作用域链上搜索，直到搜索到全局对象。


### 1. 扩展作用域

   当使用with、try catch语句的时候，解释器会在作用域链的底部添加一个变量对象，对于with语句，这个变量对象就是with语句中的对象。对于try catch，解释器会创建一个对象，存储异常中的error.


### 2. 内存管理

   javascript使用两种内存管理方式，一种是引用计数，另一种是标记清除。

   标记清除: 当变量进入内存的时候，解释器会为它们打上标记，之后当执行一个执行环境的函数代码的时候，解释器将执行环境中的所有变量的标记清除，在执行环境结束的时候，解释器对执行环境中的变量打标记。当解释器发现这些将要打标记的变量在内存中并且无标记的时候，就会将这些变量释放掉。


   引用计数: 当一个变量的引用计数为0时，解释器回收其内存。需要注意循环引用问题。在IE8之前，COM对象使用引用计数管理内存，需要注意COM对象和JS对象之间的循环引用问题，防止内存泄漏.
